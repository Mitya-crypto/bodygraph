# n8n Integration Setup

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ n8n

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ n8n

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ npm
npm install n8n -g

# –ó–∞–ø—É—Å–∫ n8n
n8n start

# –ò–ª–∏ —á–µ—Ä–µ–∑ Docker
docker run -it --rm --name n8n -p 5678:5678 n8nio/n8n
```

n8n –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:5678`

### 2. –°–æ–∑–¥–∞–Ω–∏–µ API —Ç–æ–∫–µ–Ω–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ n8n –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **API Keys**
4. –ù–∞–∂–º–∏—Ç–µ **Create API Key**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env.local`:

```env
# n8n Integration
N8N_API_TOKEN=your_jwt_token_here
N8N_BASE_URL=http://localhost:5678
```

## üéØ –°–æ–∑–¥–∞–Ω–∏–µ Workflow'–æ–≤

### Workflow 1: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π workflow**
2. **–î–æ–±–∞–≤—å—Ç–µ Webhook trigger**:
   - Method: POST
   - Path: `/classic-analysis`
   - Response: JSON

3. **–î–æ–±–∞–≤—å—Ç–µ —É–∑–ª—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏**:
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –í—ã–∑–æ–≤ API –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏–∏
   - –í—ã–∑–æ–≤ API –∞—Å—Ç—Ä–æ–ª–æ–≥–∏–∏
   - –í—ã–∑–æ–≤ API Human Design
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
   - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### Workflow 2: –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π workflow**
2. **–î–æ–±–∞–≤—å—Ç–µ Webhook trigger**:
   - Method: POST
   - Path: `/quick-analysis`
   - Response: JSON

3. **–î–æ–±–∞–≤—å—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ —É–∑–ª—ã**:
   - –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã
   - –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã
   - –ö—Ä–∞—Ç–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
   - –û—Å–Ω–æ–≤–Ω—ã–µ —á–∏—Å–ª–∞
   - –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
   - –ë—ã—Å—Ç—Ä—ã–µ —Å–æ–≤–µ—Ç—ã

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ ID workflow'–æ–≤

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è workflow'–æ–≤:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–∂–¥—ã–π workflow
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∏–∑ URL –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
3. –û–±–Ω–æ–≤–∏—Ç–µ `lib/n8nConfig.ts`:

```typescript
export const N8N_WORKFLOW_IDS = {
  scenario1: 'your-classic-workflow-id',
  scenario2: 'your-quick-workflow-id',
}
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/n8n`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Webhook)

```json
{
  "userProfile": {
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "birthDate": "1990-01-01",
    "birthTime": "12:00",
    "birthPlace": {
      "name": "–ú–æ—Å–∫–≤–∞",
      "latitude": 55.7558,
      "longitude": 37.6176
    }
  },
  "scenario": "scenario1",
  "options": {
    "includeDetailedAnalysis": true,
    "includeRecommendations": true
  }
}
```

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

```json
{
  "success": true,
  "analysis": {
    "numerology": { ... },
    "astrology": { ... },
    "humanDesign": { ... },
    "recommendations": [ ... ],
    "summary": "..."
  },
  "executionTime": "2.5s",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```typescript
import { executeN8NWorkflow } from '@/lib/n8nApi'

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
const result = await executeN8NWorkflow('scenario1', {
  userProfile: profile,
  scenario: 'scenario1',
  options: { includeDetailedAnalysis: true }
})

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
const quickResult = await executeN8NWorkflow('scenario2', {
  userProfile: profile,
  scenario: 'scenario2',
  options: { includeQuickInsights: true }
})
```

### –ß–µ—Ä–µ–∑ API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
GET /api/n8n/status

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ workflow
POST /api/n8n/execute
{
  "workflowId": "scenario1",
  "inputData": { ... },
  "scenario": "scenario1"
}

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
GET /api/n8n/execute?executionId=execution-id
```

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ n8n –∑–∞–ø—É—â–µ–Ω**:
   ```bash
   curl http://localhost:5678/api/v1/me
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω**:
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env.local`

### –ü—Ä–æ–±–ª–µ–º—ã —Å workflow'–∞–º–∏

1. **Workflow –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è**:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

2. **–û—à–∏–±–∫–∏ –≤ —É–∑–ª–∞—Ö**:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ n8n
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ API –≤—ã–∑–æ–≤–æ–≤

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [n8n Documentation](https://docs.n8n.io/)
- [n8n API Reference](https://docs.n8n.io/api/)
- [n8n Community](https://community.n8n.io/)



